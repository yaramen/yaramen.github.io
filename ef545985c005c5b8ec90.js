(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{67:function(e,t,i){e.exports=i.p+"47dd9141c7a691a5d9071da5c3548c59.png"},69:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"review-controller"},[e.isAdd||e.isEdit?i("reviewForm",{key:e.formReviewData.id,attrs:{add:e.isAdd,edit:e.isEdit,review:e.formReviewData},on:{cancel:e.cancel}}):e._e(),i("div",{staticClass:"card-list"},[i("div",{staticClass:"card-list__col"},[i("button",{staticClass:"card-list__add",on:{click:e.openFormAdd}},[i("div",{staticClass:"card-list__icon"},[e._v("+")]),e._m(0)])]),e._l(e.reviews,function(t){return i("reviewCard",{key:t.id,attrs:{review:t},on:{edit:e.editReview}})})],2)],1)};r._withStripped=!0;var a=i(3),s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("form",{staticClass:"review-form",on:{submit:e.onSendReview}},[e._m(0),i("div",{staticClass:"review-form__body"},[i("label",{staticClass:"review-form__media",attrs:{for:"avatar-file"}},[i("input",{staticClass:"review-form__file",attrs:{type:"file",id:"avatar-file"},on:{change:e.loadPhoto}}),e.review.photo?e._e():i("img",{staticClass:"review-form__avatar",attrs:{src:e.photoDefault}}),e.review.photo&&!e.photoUrl?i("img",{staticClass:"review-form__avatar",attrs:{src:""+e.serverBase+e.review.photo}}):e._e(),e.review.photo&&e.photoUrl?i("img",{staticClass:"review-form__avatar",attrs:{src:e.photoUrl}}):e._e(),i("div",{staticClass:"review-form__avatar-label"},[e._v("Добавить фото")])]),i("div",{staticClass:"review-form__content"},[i("div",{staticClass:"review-form__group"},[i("div",{staticClass:"field-group"},[i("label",{staticClass:"field-group__label",attrs:{for:"auth-name"}},[e._v("Имя автора")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.currReview.author,expression:"currReview.author"}],staticClass:"field-group__field",attrs:{type:"text",id:"auth-name",placeholder:"Введите имя"},domProps:{value:e.currReview.author},on:{input:function(t){t.target.composing||e.$set(e.currReview,"author",t.target.value)}}})]),i("div",{staticClass:"field-group"},[i("label",{staticClass:"field-group__label",attrs:{for:"auth-role"}},[e._v("Титул автора")]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.currReview.occ,expression:"currReview.occ"}],staticClass:"field-group__field",attrs:{type:"text",id:"auth-role",placeholder:"Введите "},domProps:{value:e.currReview.occ},on:{input:function(t){t.target.composing||e.$set(e.currReview,"occ",t.target.value)}}})])]),i("div",{staticClass:"field-group"},[i("label",{staticClass:"field-group__label",attrs:{for:"auth-desc"}},[e._v("Отзыв")]),i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.currReview.text,expression:"currReview.text"}],staticClass:"field-group__field",attrs:{id:"auth-desc"},domProps:{value:e.currReview.text},on:{input:function(t){t.target.composing||e.$set(e.currReview,"text",t.target.value)}}})]),i("div",{staticClass:"review-form__actions"},[i("button",{staticClass:"btn -cancel",on:{click:function(t){return e.$emit("cancel")}}},[e._v("Отмена")]),i("button",{staticClass:"btn -save",attrs:{type:"submit"}},[e._v("Сохранить")])])])])])};function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}s._withStripped=!0;var n={props:{review:Object,add:Boolean,edit:Boolean},data:function(){return{photoDefault:i(67),photoUrl:!1,currReview:this.$props.review,isAdd:this.$props.add,isEdit:this.$props.edit,serverBase:"https://webdev-api.loftschool.com/"}},methods:function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},r=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),r.forEach(function(t){o(e,t,i[t])})}return e}({},Object(a.b)("reviews",["addNewReview","updateReview"]),Object(a.b)(["showTooltip"]),{onSendReview:function(){if(this.validate()){var e=new FormData;e.append("author",this.currReview.author),e.append("occ",this.currReview.occ),e.append("text",this.currReview.text),e.append("photo",this.currReview.photo),this.isAdd?this.addNewReview(e):this.updateReview({formData:e,id:this.review.id}),this.$emit("cancel")}},loadPhoto:function(e){var t=this;this.review.photo=e.target.files[0];var i=new FileReader;try{i.readAsDataURL(this.review.photo),i.onload=function(){t.photoUrl=i.result}}catch(e){console.log(e)}},validate:function(){return 0===this.review.author.length?(this.showTooltip({type:"danger",message:"Заполните имя автора"}),!1):0===this.review.occ.length?(this.showTooltip({type:"danger",message:"Заполните титул автора"}),!1):0===this.review.text.length?(this.showTooltip({type:"danger",message:"Заполните отзыв"}),!1):!this.isAdd||this.review.photo instanceof File||(this.showTooltip({type:"danger",message:"Добавьте аватар"}),!1)}})},c=i(4),l=Object(c.a)(n,s,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"review-form__header"},[t("div",{staticClass:"review-form__title"},[this._v("Новый отзыв")])])}],!1,null,null,null);l.options.__file="src/admin/components/review-form.vue";var d=l.exports,v=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"card-list__col"},[i("div",{staticClass:"card -review"},[i("div",{staticClass:"card__header"},[i("img",{staticClass:"card__image",attrs:{src:""+e.server+e.review.photo}}),i("div",{staticClass:"card__auth"},[i("div",{staticClass:"card__auth-name"},[e._v(e._s(e.review.author))]),i("div",{staticClass:"card__auth-role"},[e._v(e._s(e.review.occ))])])]),i("div",{staticClass:"card__content"},[i("div",{staticClass:"card__desc"},[e._v(e._s(e.review.text))])]),i("div",{staticClass:"card__control"},[i("button",{staticClass:"btn -card-edit",on:{click:function(t){return e.$emit("edit",e.review.id)}}},[e._v("Править")]),i("button",{staticClass:"btn -card-remove",on:{click:function(t){return e.removeReview(e.review.id)}}},[e._v("Удалить")])])])])};function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}v._withStripped=!0;var p={props:{review:Object},data:function(){return{server:"https://webdev-api.loftschool.com/"}},methods:function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},r=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),r.forEach(function(t){u(e,t,i[t])})}return e}({},Object(a.b)("reviews",["removeReview"]))},w=Object(c.a)(p,v,[],!1,null,"8538cbf6",null);function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},r=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),r.forEach(function(t){h(e,t,i[t])})}return e}function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}w.options.__file="src/admin/components/review-card.vue";var _={components:{reviewForm:d,reviewCard:w.exports},data:function(){return{isAdd:!1,isEdit:!1,reviewData:{author:"",occ:"",text:"",photo:""},editingReviewId:0}},computed:f({},Object(a.c)("reviews",{reviews:function(e){return e.reviews}}),{formReviewData:function(){var e=this,t=f({},this.reviewData);return this.isEdit&&(t=f({},this.reviews.find(function(t){return t.id===e.editingReviewId}))),console.log(t),t}}),methods:f({},Object(a.b)("reviews",["getAllReviews"]),{openFormAdd:function(){this.isAdd=!0,this.isEdit=!1},cancel:function(){this.isAdd=!1,this.isEdit=!1},editReview:function(e){this.isEdit=!0,this.isAdd=!1,this.editingReviewId=e}}),created:function(){this.getAllReviews()}},m=Object(c.a)(_,r,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"card-list__text"},[this._v("Добавить"),t("br"),this._v(" отзыв")])}],!1,null,null,null);m.options.__file="src/admin/components/pages/review.vue";t.default=m.exports}}]);